<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Outfit:wght@100..900&display=swap" rel="stylesheet">


    <link rel="icon" type="image/png" href="im.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">

    <script src="https://unpkg.com/boxicons@2.1.4/dist/boxicons.js"></script>

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
 
    
    {% load static %}
    <link rel="stylesheet" href="{% static 'prototipo.css' %}">  

    <title>PharmaGo</title>
</head>
<body>

    <div class="fondo"></div>
    <div class="capa"></div>

    <div class="container">
        <h2><box-icon name='cart-download' type='solid' size='40px'  color="#d6dbdf" class="icono-usuario"></box-icon> Prototipo</h2>
        <ul>
            <li> <a href="{% url 'inicio' %}"><box-icon name='log-in-circle' type='solid' animation='tada' color="#d6dbdf" class="icono-regresar"></box-icon>
                <span> Regresar </span></a></li>
        </ul>   
    </div>


    <div class="content" id="inicio">
        <p>Bienvenido al prototipo de PharmaGo</p>
    </div>


<div class="container-fluid"> 

    <div class="content-wrapper">
        <div class="left-container">
            <box-icon name='car-battery' type='solid' size='130px' color='#283747' ></box-icon>
            <h2>Información de la Batería</h2>
            <br>
            <p><input type="number" class="battery-level" name="battery-level-level" id="battery-level-level" value={{proto.voltaje}} style="border: none;"> </p>
            

            <!-- Agregue estooo -->
            <div class="battery-container">
                <div class="battery">
                    <div class="battery-level" id="battery-level"></div>
                </div>
                <p id="battery-text">Cargando...</p>
            </div>
            <!-- Aaqui -->
            
        </div>
        <div class="divider"></div>
        <div class="right-container">
            <box-icon name='line-chart' size='130px' color='#283747'></box-icon>
            <h2>Latitud y Longitud</h2>
            <br>
            <p>Latitud: {{proto.latitud}} Longitud: {{proto.longitud}}</p>
        </div>
    </div>
    

     <div class="content-wrapper">
        <div class="left-container">
            <box-icon name='stats' size='130px' color='#283747'></box-icon>
            <h2>Estado</h2>
            <br>
            <p>{{proto.estadoPrototipo}}</p>
        </div>
        <div class="divider"></div>
        <div class="right-container">
            <box-icon type='solid' name='face' size='130px' color='#283747'></box-icon>
            <h2>Médico Encargado</h2>
            <br>
            <p>{{proto.idUsuario}}</p>
            <p>{{proto.nombreUsuario}}</p>
        </div>
    </div>
    
<script>
    setTimeout(function(){
        window.location.reload();
    }, 10000);
</script>
</div>

<footer class="footer">
    <div class="footer-content">
        <h3>PharmaGo</h3>
        <p>Optimiza la gestión de medicamentos con nuestra solución inteligente y autónoma para hospitales.</p>
        <ul class="socials">
            <li><a href="#"><i class="fa fa-facebook"> </i></a></li>
            <li><a href="#"><i class="fa fa-twitter"> </i></a></li>
            <li><a href="#"><i class="fa fa-youtube"> </i></a></li>
            <li><a href="#"><i class="fa fa-google-plus"> </i></a></li> 
        </ul>
    </div>
    
    <div class="footer-bottom">
        <p>&copy; 2025 PharmaGo. Todos los derechos reservados. Diseñado por <strong>Vet To Care</strong></p>
    </div>
</footer>


<!-- Agregue estooo y si fue de chat -->
<script>
const input = document.getElementById("battery-level-level");
// Simulamos el nivel de batería (valor inicial)
let batteryLevel = input.value; // Máximo es 8 Este valor lo debes de conectar a lo que manda el arduino.

// Seleccionamos los elementos de la barra y el texto
const batteryElement = document.getElementById("battery-level");
const batteryText = document.getElementById("battery-text");

// Verificamos si los elementos existen
if (!batteryElement || !batteryText) {
    console.error("Elementos de batería no encontrados.");
}

// Función para actualizar la barra de batería y el texto
function updateBatteryLevel(level) {
    level = parseFloat(level); // Asegurarse de que sea número

    // Calcular el porcentaje
    const percentage = Math.max(0, Math.min((level / 8) * 100, 100));
    batteryElement.style.width = percentage + "%";

    // Lógica de colores
    if (level >= 7) {
        batteryElement.style.backgroundColor = "#117864"; // Verde
        batteryText.textContent = "Carga completa";
    } else if (level >= 5) {
        batteryElement.style.backgroundColor = "#f1c40f"; // Amarillo
        batteryText.textContent = "Carga media";
    } else {
        batteryElement.style.backgroundColor = "#7b241c"; // Rojo
        batteryText.textContent = "Baja carga";
    }
}

// Mostrar el nivel inicial
updateBatteryLevel(batteryLevel);

// Simular la descarga de la batería cada 5 segundos
setInterval(() => {
    if (batteryLevel > 0) {
        batteryLevel = Math.max(0, batteryLevel - 0.5); // No baja de 0
    }
    updateBatteryLevel(batteryLevel);
}, 5000);
</script>



</body>
</html>
